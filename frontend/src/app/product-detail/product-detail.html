<div class="product-detail-container" *ngIf="product">
    <div class="product-main-content">
        <div class="product-images-wrapper">
            <!-- Main Image / Video -->
            <div class="main-image-container">
                <ng-container *ngIf="!showVideo; else videoPlayer">
                    <img [src]="displayImage" [alt]="product.name" class="main-img">
                </ng-container>
                <ng-template #videoPlayer>
                    <video controls autoplay class="main-video">
                        <source [src]="product.videoUrl" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </ng-template>
            </div>

            <!-- Thumbnails bottom -->
            <div class="thumbnails-bottom">
                <div *ngFor="let img of thumbnails; let i = index" class="thumbnail-item"
                    [class.active]="i === activeImageIndex && !showVideo" (click)="setActiveImage(i)">
                    <img [src]="img" [alt]="product.name">
                </div>

                <!-- Video Thumbnail (if product has video) -->
                <div *ngIf="product.videoUrl" class="thumbnail-item video-thumbnail" [class.active]="showVideo"
                    (click)="setShowVideo(true)">
                    <div class="play-icon-overlay">
                        <i class="fas fa-play"></i>
                    </div>
                    <!-- Use main product image as video thumbnail poster -->
                    <img [src]="product.image" alt="Watch Video">
                </div>
            </div>

            <!-- ABOUT PRODUCT Section -->
            <div class="about-section">
                <h3 class="section-title">About The Product</h3>
                <p class="about-text">
                    Easy to grow and care for, this plant is a popular indoor plant because of more reasons than just
                    its
                    care requirements. According to Feng Shui, this is one of the best lucky plants for homes, and its
                    reputation as such greatly adds to its charm and allure. Additionally, it is also a great gifting
                    option
                    that works as a personal pick-me-up!
                </p>

                <!-- Go to Home Button (Moved here for better layout) -->
                <a routerLink="/" class="go-home-btn">
                    <i class="fas fa-home"></i> Go to Home
                </a>
            </div>
        </div>

        <!-- Product Details Sidebar -->
        <div class="product-info-wrapper">
            <h1 class="product-title">{{ product.name }}</h1>
            <div class="rating">
                <i class="fas fa-star"></i> 4.8 | 195
            </div>
            <div class="price-block">
                <span class="current-price">₹{{ product.price }}</span>
                <span class="original-price" *ngIf="product.originalPrice">₹{{ product.originalPrice }}</span>
                <span class="discount-badge" *ngIf="product.discount">{{ product.discount }}</span>
            </div>
            <span class="taxes-text">(Incl. of all taxes)</span>

            <!-- SELECT PLANTER - Ugaoo Style -->
            <div class="planter-section">
                <p class="section-label">SELECT PLANTER</p>
                <div class="planter-options">
                    <div *ngFor="let planter of planters; let i = index" class="planter-option"
                        [class.selected]="selectedPlanter === planter.id" (click)="selectPlanter(planter.id)">
                        <!-- Most Loved Badge -->
                        <span class="most-loved-badge" *ngIf="i === 1">
                            <i class="fas fa-heart"></i> Most Loved
                        </span>
                        <!-- Pot Icon -->
                        <div class="pot-icon-wrapper">
                            <img [src]="planter.thumbnail" [alt]="planter.name" class="planter-thumb">
                        </div>
                        <!-- Planter Name -->
                        <span class="planter-name">{{ planter.name }}</span>
                        <!-- Planter Price -->
                        <span class="planter-price">{{ planter.price }}</span>
                        <!-- Selected Checkmark -->
                        <div class="check-mark" *ngIf="selectedPlanter === planter.id">
                            <i class="fas fa-check"></i>
                        </div>
                    </div>
                </div>
            </div>

            <label class="gift-option">
                <input type="checkbox"> Make This a Gift
            </label>

            <div class="actions">
                <div class="quantity-selector">
                    <button (click)="decreaseQuantity()">-</button>
                    <span>{{ quantity }}</span>
                    <button (click)="increaseQuantity()">+</button>
                </div>
                <button class="add-to-cart-btn btn" (click)="addToCart()">ADD TO CART</button>
                <button class="buy-now-btn btn" (click)="buyNow()">BUY IT NOW</button>
            </div>

            <div style="color: #008f53; font-weight: 600; margin-top: 25px; margin-bottom: 15px; cursor: pointer;">
                <i class="fas fa-leaf"></i> View Light guide
            </div>

            <!-- FAQs (Under Buttons as requested) -->
            <div class="features-list">
                <div *ngFor="let faq of currentFaqs" class="feature-card" [class.expanded]="expandedFeature === faq.id"
                    (click)="toggleFeature(faq.id)">
                    <div class="feature-header">
                        <div class="feature-icon-box">
                            <img [src]="faq.icon" [alt]="faq.title" class="feature-icon-img">
                        </div>
                        <span class="feature-text">{{ faq.title }}</span>
                        <i class="fas fa-chevron-down arrow-icon"></i>
                    </div>
                    <div class="feature-content" *ngIf="expandedFeature === faq.id">
                        <p>{{ faq.content }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Related Products -->
    <div class="related-products-container" *ngIf="relatedProducts.length > 0">
        <h2 class="related-title">Related Products</h2>
        <div class="related-products-grid">
            <div class="product-card" *ngFor="let p of relatedProducts" [routerLink]="['/product', createSlug(p.name)]">
                <div class="card-image">
                    <img [src]="p.image" [alt]="p.name">
                    <span class="card-discount" *ngIf="p.discount">{{ p.discount }}</span>
                </div>
                <div class="card-details">
                    <h3 class="card-title">{{ p.name }}</h3>
                    <div class="card-price-row">
                        <span class="card-price">₹{{ p.price }}</span>
                        <span class="card-original-price" *ngIf="p.originalPrice">₹{{ p.originalPrice }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div *ngIf="!product" style="padding: 100px; text-align: center;">
    <h2>Product Not Found</h2>
    <p>We couldn't find the product you're looking for.</p>
    <a routerLink="/" style="color: #2e7d32; text-decoration: underline;">Go Back Home</a>
</div>